<% content_for :navigation do %>
  <nav class="nav nav-tabs align-self-end">
    <% @categories.each do |category| %>
      <div class="nav-item">
        <%= link_to [@district, @school, category, { year: @academic_year.range }], class: ["nav-link", current_page?([@district, @school, category, { year: @academic_year.range }]) ? "active" : ""] do %>
          <i class="<%= category.icon_class %> me-2"></i> <%= category.name %>
        <% end %>
      </div>
    <% end %>
  </nav>
<% end %>

<h1 class="sub-header font-bitter color-red"><%= @category.name %></h1>
<p class="col-8 body-large"><%= @category.description %></p>

<% @category.subcategories(academic_year: @academic_year, school: @school).each do |subcategory| %>
  <section class="subcategory-section">
    <div class="p-7">

    <h2 class="sub-header-2 font-bitter mb-7"><%= subcategory.name %></h2>

    <div class="d-flex justify-content-between align-items-end">
      <div>
        <%= render partial: "gauge_graph", locals: { gauge: subcategory.gauge_presenter, gauge_class: 'gauge-graph-lg', font_class: 'sub-header-3' } %>
      </div>
      <p class="body-large mx-7"><%= subcategory.description %></p>
    </div>
    </div>

    <div class="arrow-container mt-7">
      <div class="arrow-shadow"></div>
      <div class="arrow"></div>
    </div>

    <div class="measure-card d-flex justify-space-between p-7">
      <% subcategory.measure_presenters.each do |measure_presenter| %>
        <div class="measure-presenter d-flex flex-column justify-content-between align-items-center mx-4">
          <h3 class="measure-description sub-header-4 mb-5 "><%= measure_presenter.name %></h3>
          <div>
            <%= render partial: "gauge_graph", locals: { gauge: measure_presenter.gauge_presenter, gauge_class: 'gauge-graph-sm', font_class: 'weight-700' } %>
          </div>
          <p class="measure-description body-small mt-5 mb-4"><%= measure_presenter.description %></p>
        </div>
      <% end %>
    </div>

  </section>
<% end %>
